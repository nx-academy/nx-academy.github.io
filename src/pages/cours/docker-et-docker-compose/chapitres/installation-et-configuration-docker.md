---
layout: ../../../../layouts/ChapterLayout.astro

title: Installez et configurez Docker Desktop
description: Une nouvelle super description d√©di√©e √† Docker

previousChapterLink: decouverte-docker
nextChapterLink: presentation-projet-fil-rouge

chapterNumber: 2
sectionNumber: 1
sectionTitle: Partie 1 - Initiez-vous √† Docker et au projet fil rouge
id: 2
---

<artice>

# Installez et configurez Docker Desktop

![Un superhero regardant une ville de nuit, pixel art](/cours-docker/port-avec-conteneurs.png)

## D√©couvrez Docker Desktop

Dans ce chapitre, vous allez prendre en main Docker Desktop. Je vous montrerais comment l‚Äôinstaller. Vous apprendrez √† r√©cup√©rer (on dit aussi ‚Äúpuller‚Äù) vos premi√®res images. Ce chapitre me permettra aussi de vous montrer des commandes Docker indispensables.

Si vous √™tes sur Linux, vous n‚Äôaurez pas besoin d‚Äôinstaller Docker Desktop. En effet, pour fonctionner Docker a besoin de Linux pour fonctionner. Donc, si vous √™tes sur Linux, pas de probl√®mes : vous pouvez installer Docker directement. Par contre, si vous √™tes sur Mac ou PC, vous aurez besoin d‚Äôune VM, VM qui tournera sur Linux. C‚Äôest Docker Desktop qui va se g√©rer d‚Äôinstaller et de tenir √† jour cette VM pour vous.

Sachez que Docker Desktop est sur un mod√®le Freemium : l‚Äôoutil est gratuit pour les particuliers et les entreprises de moins de 250 employ√©s ou dont le chiffre d‚Äôaffaires est inf√©rieur √† 10 millions de dollars. Ce changement tarifaire a eu lieu en ao√ªt 2021 et a fait pas mal parl√© de lui. Voici deux articles du monde informatique vous expliquant le pourquoi du comment : [le premier article](https://www.lemondeinformatique.fr/actualites/lire-docker-desktop-n-est-plus-gratuit-pour-les-entreprises%C2%A0-84012.html) et [le deuxi√®me](https://www.lemondeinformatique.fr/actualites/lire-face-a-la-gronde-docker-justifie-la-fin-de-free-teams-89884.html).

Si √ßa vous int√©resse d‚Äôen apprendre un peu plus sur le fonctionnement interne de Docker Desktop, vous pouvez lire [cet article](https://www.docker.com/blog/the-magic-behind-the-scenes-of-docker-desktop/) tir√© du blog officiel de Docker.

---

<br>

![Un superhero regardant une ville de nuit, pixel art](/cours-docker/installation-logiciel.png)

## Installez Docker Desktop sur macOS

Dans ce screencast, vous allez voir comment installer Docker sur macOS. Vous verrez o√π et comment installer Docker Desktop, quelques commandes de base et vous en profiterez pour lancer votre premier conteneur.

<iframe src="https://www.youtube.com/embed/SYMPIdMC2qo" frameborder="0"  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

F√©licitations, Docker Desktop est maintenant pr√™t √† l‚Äôemploi sur votre ordinateur. La commande `docker run hello-world` est l‚Äôune des nombreuses commandes de Docker. Cette commande vous permet de lancer un conteneur avec l‚Äôimage ayant le nom _hello-world_. Cette image est h√©berg√©e [sur ce repository DockerHub](https://hub.docker.com/_/hello-world).

---

<br>

![Un superhero regardant une ville de nuit, pixel art](/cours-docker/installation-logiciel.png)

## Installez Docker Desktop sur Windows

N‚Äôayant actuellement pas d‚Äôordinateur sur Windows me permettant de faire tourner Docker, je vous partage ce tuto Youtube. D√®s que j‚Äôaurais un moyen simple de le faire, je mettrais √† jour ce cours.

<iframe src="https://www.youtube.com/embed/SYMPIdMC2qo" frameborder="0"  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

F√©licitations, Docker Desktop est maintenant pr√™t √† l‚Äôemploi sur votre ordinateur. La commande `docker run hello-world` est l‚Äôune des nombreuses commandes de Docker. Cette commande vous permet de lancer un conteneur avec l‚Äôimage ayant le nom _hello-world_. Cette image est h√©berg√©e [sur ce repository DockerHub](https://hub.docker.com/_/hello-world).

---

<br>

![Un superhero regardant une ville de nuit, pixel art](/cours-docker/hacker-sombre.png)

## Appr√©hendez la ligne de commande de Docker

Vous allez voir au fur et √† mesure du cours qu‚Äôil y a beaucoup de commandes possibles avec Docker. Il y a des commandes dont vous vous servez quasiment tout le temps et d‚Äôautres un peu moins.

Il existe une commande centrale : `docker ‚Äîhelp`. Ouvrez votre terminal et tapez cette commande. Vous devriez avoir un r√©sultat proche du mien.

```bash
docker --help


Usage:  docker [OPTIONS] COMMAND

A self-sufficient runtime for containers

Options:
  	--config string  	Location of client config files (default "/Users/family/.docker")
  -c, --context string 	Name of the context to use to connect to the daemon (overrides DOCKER_HOST env var and default context set with "docker context use")
  -D, --debug          	Enable debug mode
  -H, --host list      	Daemon socket(s) to connect to
  -l, --log-level string   Set the logging level ("debug"|"info"|"warn"|"error"|"fatal") (default "info")
  	--tls            	Use TLS; implied by --tlsverify
  	--tlscacert string   Trust certs signed only by this CA (default "/Users/family/.docker/ca.pem")
  	--tlscert string 	Path to TLS certificate file (default "/Users/family/.docker/cert.pem")
  	--tlskey string  	Path to TLS key file (default "/Users/family/.docker/key.pem")
  	--tlsverify      	Use TLS and verify the remote
  -v, --version        	Print version information and quit

Management Commands:
  builder 	Manage builds
  buildx* 	Docker Buildx (Docker Inc., v0.10.3)
  compose*	Docker Compose (Docker Inc., v2.15.1)
  # [...]
  trust   	Manage trust on Docker images
  volume  	Manage volumes

Commands:
  attach  	Attach local standard input, output, and error streams to a running container
  build   	Build an image from a Dockerfile
  # [...]
  version 	Show the Docker version information
  wait    	Block until one or more containers stop, then print their exit codes

Run 'docker COMMAND --help' for more information on a command.
```

Si vous n‚Äôavez pas l‚Äôhabitude, je vous invite √† utiliser l‚Äôargument `--help` sur tous les programmes en CLI que vous utilisez. C‚Äôest souvent votre meilleur ami pour apprendre comment une commande fonctionne. Vous pouvez aussi avoir plus d‚Äôinformations sur une commande en particulier via la docker `COMMAND --help` (c.f. la derni√®re ligne du bout de code ci-dessus).

<br>

Vous avez pr√©c√©demment lanc√© la commande docker run hello-world. Pour afficher l‚Äôaide de cette commande, tapez `docker run ‚Äìhelp`. Vous devriez avoir un r√©sultat semblable √† celui ci-dessous.

```bash
docker run --help


Usage:  docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

Run a command in a new container

Options:
  	--add-host list              	Add a custom host-to-IP mapping (host:ip)
  -a, --attach list                	Attach to STDIN, STDOUT or STDERR
  	--blkio-weight uint16        	Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)
  	--blkio-weight-device list   	Block IO weight (relative device weight) (default [])
  	--cap-add list               	Add Linux capabilities
  	--cap-drop list              	Drop Linux capabilities
  	--cgroup-parent string       	Optional parent cgroup for the container
  	--cgroupns string            	Cgroup namespace to use (host|private)
                                   	'host':	Run the container in the Docker host's cgroup
# [...]
  -v, --volume list                	Bind mount a volume
  	--volume-driver string       	Optional volume driver for the container
  	--volumes-from list          	Mount volumes from the specified container(s)
  -w, --workdir string             	Working directory inside the container
```

Je sais ce que vous vous dites : √ßa fait beaucoup d‚Äôinformations pour une simple commande. Vous n‚Äôavez pas besoin de tout savoir et de tout conna√Ætre. Il faut juste savoir que √ßa existe et comment acc√©der √† cette information. Comme la description le pr√©cise, la commande `docker run` permet de lancer une commande dans un nouveau conteneur.

<br>

La partie Usage est particuli√®rement importante : elle vous permet de voir ce qui est requis et optionnel √† votre commande.

```bash
Usage:  docker run [OPTIONS] IMAGE [COMMAND] [ARG...]
```

<br>

- `[OPTIONS]` est optionnelle. Ce sont toutes les options que vous allez pouvoir passer √† Docker et plus pr√©cis√©ment, dans le cas ci-dessus, √† une image Docker. Pour rappel la liste des options est affich√©e avec la commande `docker run ‚Äìhelp`.
- `IMAGE` est obligatoire. Cela correspond √† l‚Äôimage que vous allez utiliser pour votre conteneur Docker. Vous avez pr√©c√©demment utilis√© l‚Äôimage hello-world.
- `[COMMAND]` est optionnelle. C‚Äôest la commande que vous allez lancer dans votre conteneur Docker. Par exemple, yarn ou yarn dev ou ls. Vous verrez dans la derni√®re section quelques exemples de commandes.
- `[ARG‚Ä¶]` est aussi optionnelle. Ce sont les arguments de votre commande. Par exemple, --help ou plus pr√©cis√©ment yarn ‚Äìhelp ou npm ‚Äìhelp. Vous pourriez ainsi avoir une commande tel que `docker run my-image npm run dev ‚Äìport 3000`, √† savoir lancer un conteneur avec une image my-image o√π la commande pour lancer le projet est npm run dev.

<br>

√Ä ce stade du cours, il est possible que vous soyez encore perdu entre les images et les conteneurs. C‚Äôest parfaitement normal. On passe tous par cette √©tape (en tout cas, j‚Äôy suis pass√© ^^). Une image Docker est comme une empreinte digitale ou un moule ; souvenez-vous de l‚Äôexemple des g√¢teaux. Votre image est pr√™te √† l‚Äôemploi mais elle ne ‚Äútourne‚Äù pas.

Pour ex√©cuter le code ou le programme contenu dans votre image, vous avez besoin de la faire tourner dans un conteneur. La commande `docker run` permet donc de faire tourner l‚Äôimage Docker dans un conteneur Docker. Le conteneur Docker correspond √† votre g√¢teau üôÇ.

Dernier point essentiel : la commande `docker run` est une abr√©viation de la commande `docker container run`. Vous allez voir qu‚Äôil existe beaucoup de commandes abr√©g√©es. J‚Äôavoue ne pas √™tre tr√®s fan de ces commandes abr√©g√©es. Elles ont tendance √† nous faire oublier ce qu‚Äôon manipule, √† savoir un conteneur, une image, un r√©seau, etc.

Durant tout le cours, je vais utiliser les commandes compl√®tes, √† savoir docker container run, docker container exec, docker image pull, etc. Cela devrait vous aider √† acc√©l√©rer votre apprentissage.

<br>

On va se faire un premier screencast o√π je vais reprendre les notions dont je viens de parler. Vous verrez ensuite d‚Äôautres commandes de base de Docker.

<iframe src="https://www.youtube.com/embed/SYMPIdMC2qo" frameborder="0"  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

Maintenant que vous avez pris en main l‚Äôinterface en ligne de commandes de Docker (le CLI), vous allez apprendre √† r√©cup√©rer une image Node.js depuis DockerHub.

---

<br>

## R√©cup√©rez une image Node.JS

**Pour r√©cup√©rer une image Docker NodeJS, la premi√®re est de savoir o√π et comment la r√©cup√©rer**. Pour le ‚Äúo√π‚Äù, normalement, vous ne devriez pas √™tre surpris si je vous parle de Dockerhub. Allez [sur Dockerhub](https://hub.docker.com/) et tapez _Node_ dans la barre de recherche. Vous devriez avoir des r√©sultats similaires √† l‚Äôimage ci-dessous.

<br>

![La page de recherche de DockerHub quand vous tapez Node.JS dans la barre de recherche](/dockerhub-node.png)

<br>

Vous voyez le texte √©crit en vert (en esp√©rant que vous ne soyez pas daltonien üòÄ) : ‚ÄúDocker Official Image‚Äù. **Quand vous choisissez votre image sur DockerHub, essayez de privil√©gier les images officielles**. C‚Äôest un signe de qualit√© (et de s√©curit√©), autrement dit, vous pouvez y aller les yeux ferm√©s. D‚Äôailleurs, le site de DockerHub l‚Äôexplique lui aussi :

<br>

![Une capture d'√©cran montrant les avantages des images officielles selon Docker](/avantages-image-officielle-docker.png)

<br>

Cliquez sur la page de Node, vous devriez l√† encore avoir un r√©sultat similaire √† l‚Äôimage ci-dessous.

<br>

![Une capture d'√©cran de l'image officielle de Node.JS sur DockerHub](/image-officielle-node-js.png)

<br>

Il y a beaucoup d‚Äôinformations affich√©es √† l‚Äô√©cran mais celle qui m‚Äôint√©resse est situ√©e en haut √† droite : `docker pull node`. **Cette commande va vous permettre de r√©cup√©rer la derni√®re image de Node en date**. C‚Äôest l'abr√©viation de la commande `docker image pull node`. Ouvrez votre terminal et lancez cette commande. Cela va vous faire t√©l√©charger la derni√®re image Node, sauf si vous avez d√©j√† r√©cup√©r√© cette image au pr√©alable.

Pour consulter les images pr√©sentes sur votre ordinateur, tapez la commande `docker image ls`.

<br>

```bash
docker image ls

REPOSITORY	TAG   	IMAGE ID   	CREATED     	SIZE
node      	latest	c080a37e3dd2   18 hours ago	949MB
hello-world   latest	46331d942d63   12 months ago   9.14kB
```

<br>

J‚Äôai deux images sur mon ordinateur : `node` et `hello-world`. J‚Äôai leur taille, le nom du repository et leur tag. Sachez que nous reviendrons sur la notion de tag d‚Äôici peu de temps üòâ.

<br>

Le screencast ci-dessous reprend ce que je viens de faire mais en vid√©o. Encore une fois, cela devrait vous permettre d‚Äôapprendre un peu plus vite.

---

<br>

## Lancez et manipulez votre conteneur Node.js

Commencez par taper la commande `docker container ‚Äìhelp` dans votre terminal.

<br>

```bash
docker container --help


Usage:  docker container COMMAND

Manage containers

Commands:
  attach  	Attach local standard input, output, and error streams to a running container
  commit  	Create a new image from a container's changes
  cp      	Copy files/folders between a container and the local filesystem
  # [...]
  unpause 	Unpause all processes within one or more containers
  update  	Update configuration of one or more containers
  wait    	Block until one or more containers stop, then print their exit codes

Run 'docker container COMMAND --help' for more information on a command.
```

Essayez de lire un peu ce que fait chacune des commandes. **Sachez qu‚Äôon utilise r√©guli√®rement les commandes** `docker container exec`, `docker container run`, `docker container ls` et `docker container kill`. Lisez un peu la documentation de chacune de ces commandes avec le _--help_. Pour √™tre tout √† fait honn√™te, je trouve la documentation du CLI de Docker particuli√®rement bien fournie et claire.

<br>

On va maintenant lancer notre premier conteneur Node.js. V√©rifiez que vous avez bien l‚Äôimage de Node sur votre ordinateur via la commande docker image ls. Puis, √©crivez docker container run node ls dans votre terminal et appuyez sur entrer.

```bash
docker container run node ls

bin
boot
dev
etc
home
# [...]
usr
var
```

Cette commande va vous permettre d'ex√©cuter la commande ls √† l‚Äôint√©rieur de votre conteneur. Vous √™tes actuellement √† la racine de votre linux. Pour afficher le contenu du r√©pertoire bin, tapez docker container run node ls bin. Si vous connaissez un peu linux et la ligne de commandes, vous ne devriez pas √™tre trop perdu.

<br>

Admettons maintenant que vous souhaitez conna√Ætre la version de node de votre conteneur Docker. Vous pouvez le faire via la commande docker container run node node -v.

```bash
docker container run node node -v

v19.8.1
```

---

<br>

![Un vendeur de journaux dans une rue, pixel art](/vendeur-journaux.webp)

## R√©sum√©

- Il est important de bien faire la diff√©rence entre une image et un conteneur Docker. Essayez, notamment au d√©but, de toujours vous poser la question si vous manipulez une image ou un conteneur. Vous pouvez avoir 10, 20, 30 conteneurs qui utilisent la m√™me image.
- L‚Äôinterface en ligne de commandes (le CLI) de Docker vous donne beaucoup d‚Äôinformations sur comment utiliser Docker. Prenez l‚Äôhabitude d‚Äôutiliser l‚Äôoption `--help`. Par exemple, `docker ‚Äìhelp`, `docker volume ‚Äìhelp`, etc.
- Essayez d‚Äôutiliser le moins possible les commandes abr√©g√©es. Par exemple, `docker container ls` au lieu de `docker ps`. Cela va vous permettre de mieux comprendre ce que vous manipulez.

</article>
